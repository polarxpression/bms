---
import "../styles/global.css";

interface Props {
	title: string;
}

const { title } = Astro.props;
const currentPath = Astro.url.pathname;

const navItems = [
	{ href: "/", label: "Visão Geral", icon: "dashboard" },
	{ href: "/inventory", label: "Inventário", icon: "inventory_2" },
	{ href: "/map", label: "Mapa", icon: "map" },
	{ href: "/buy", label: "Compra Externa", icon: "shopping_cart" },
	{ href: "/history", label: "Histórico", icon: "history" },
	{ href: "/settings", label: "Configurações", icon: "settings" },
];
---

<!doctype html>
<html lang="pt-BR" class="scroll-smooth">
	<head>
		<meta charset="UTF-8" />
		<meta name="description" content="PowerTrack BMS Web" />
		<meta name="viewport" content="width=device-width" />
		<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
		<meta name="generator" content={Astro.generator} />
		<title>{title} | PowerTrack BMS</title>
		<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
		<link rel="preconnect" href="https://fonts.googleapis.com">
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
		<link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">
	</head>
	<body class="bg-[#050505] text-gray-100 font-['Plus_Jakarta_Sans',sans-serif] min-h-screen flex flex-col md:flex-row antialiased selection:bg-[#EC4899]/30 selection:text-white">
		<!-- Mobile Header -->
		<header class="md:hidden sticky top-0 z-50 bg-[#141414]/80 backdrop-blur-xl p-4 flex justify-between items-center border-b border-white/5">
			<div class="flex items-center gap-2">
				<div class="w-8 h-8 rounded-lg bg-gradient-to-br from-[#EC4899] to-[#8B5CF6] flex items-center justify-center shadow-lg shadow-pink-500/20">
					<span class="material-icons text-white text-lg">bolt</span>
				</div>
				<h1 class="text-xl font-bold bg-gradient-to-r from-white to-gray-400 bg-clip-text text-transparent">PowerTrack</h1>
			</div>
			<button id="menu-btn" class="w-10 h-10 flex items-center justify-center rounded-xl bg-white/5 text-white active:scale-90 transition-transform">
				<span class="material-icons">menu</span>
			</button>
		</header>

		<!-- Sidebar -->
		<aside id="sidebar" class="hidden md:flex flex-col w-72 bg-[#141414] border-r border-white/5 h-screen fixed top-0 left-0 z-50 transition-all duration-300 md:translate-x-0 overflow-hidden">
			<div class="p-8">
				<div class="flex items-center gap-3 mb-2">
					<div class="w-10 h-10 rounded-xl bg-gradient-to-br from-[#EC4899] to-[#8B5CF6] flex items-center justify-center shadow-xl shadow-pink-500/20">
						<span class="material-icons text-white">bolt</span>
					</div>
					<div>
						<h1 class="text-2xl font-extrabold text-white tracking-tight leading-none">PowerTrack</h1>
						<p class="text-[10px] text-[#EC4899] font-black uppercase tracking-[0.2em] mt-1 opacity-80">System v2.0</p>
					</div>
				</div>
			</div>
			
			<nav class="flex-1 overflow-y-auto py-2 px-4 custom-scrollbar">
				<ul class="space-y-1.5">
					{navItems.map((item) => {
						const isActive = currentPath === item.href || (item.href !== '/' && currentPath.startsWith(item.href));
						return (
							<li>
								<a 
									href={item.href} 
									class={`flex items-center px-4 py-3.5 rounded-2xl transition-all duration-200 group relative ${
										isActive 
											? 'bg-gradient-to-r from-[#EC4899]/10 to-transparent text-white' 
											: 'text-gray-400 hover:text-white hover:bg-white/5'
									}`}
								>
									{isActive && <div class="absolute left-0 top-1/2 -translate-y-1/2 w-1 h-6 bg-[#EC4899] rounded-r-full shadow-[0_0_15px_#EC4899]"></div>}
									<span class={`material-icons mr-3.5 transition-colors ${isActive ? 'text-[#EC4899]' : 'group-hover:text-[#EC4899]'}`}>
										{item.icon}
									</span>
									<span class="font-semibold tracking-tight">{item.label}</span>
									{!isActive && <span class="material-icons ml-auto text-gray-600 opacity-0 group-hover:opacity-100 transition-all -translate-x-2 group-hover:translate-x-0 text-sm">chevron_right</span>}
								</a>
							</li>
						);
					})}
				</ul>
			</nav>

			<div class="p-6">
				<div class="p-4 rounded-2xl bg-gradient-to-br from-[#1c1c1c] to-[#141414] border border-white/5 flex items-center gap-4 shadow-2xl relative overflow-hidden group">
					<div class="absolute inset-0 bg-gradient-to-r from-[#EC4899]/5 to-transparent opacity-0 group-hover:opacity-100 transition-opacity"></div>
					<div class="w-10 h-10 rounded-full bg-gradient-to-tr from-[#EC4899] to-[#FF8AD8] p-[2px] shadow-lg shadow-pink-500/10">
						<div class="w-full h-full rounded-full bg-[#141414] flex items-center justify-center text-white text-sm font-bold">
							AD
						</div>
					</div>
					<div class="flex-1 min-w-0">
						<p class="text-sm font-bold text-white truncate">Administrator</p>
						<div class="flex items-center gap-1.5">
							<div class="w-1.5 h-1.5 rounded-full bg-green-500 animate-pulse"></div>
							<p class="text-[10px] text-gray-500 font-bold uppercase tracking-wider">Sistema Ativo</p>
						</div>
					</div>
					<button class="text-gray-600 hover:text-white transition-colors">
						<span class="material-icons text-lg">logout</span>
					</button>
				</div>
			</div>
		</aside>

		<!-- Main Content -->
		<main class="flex-1 md:ml-72 p-4 md:p-10 overflow-y-auto h-[calc(100vh-64px)] md:h-screen custom-scrollbar">
			<div class="max-w-6xl mx-auto animate-fade-in">
				<slot />
			</div>
		</main>

		<script>
			// Mobile menu toggle logic
			const btn = document.getElementById('menu-btn');
			const sidebar = document.getElementById('sidebar');
			let isOpen = false;
			
			btn?.addEventListener('click', () => {
				isOpen = !isOpen;
				if (isOpen) {
					sidebar?.classList.remove('hidden');
					sidebar?.classList.add('flex', 'absolute', 'w-full', 'inset-0');
				} else {
					sidebar?.classList.add('hidden');
					sidebar?.classList.remove('flex', 'absolute', 'w-full', 'inset-0');
				}
			});
		</script>
	</body>
</html>

